"use strict";let searchSerie="";const getUserInput=()=>{const e=document.querySelector("#search-input");return searchSerie=e.value};let dataList=[];const getDataFromServer=()=>{fetch(`http://api.tvmaze.com/search/shows?q=${searchSerie}`).then(e=>e.json()).then(e=>{saveData(e),printResultSeries()})},setSerieAsFavorite=()=>{for(const e of dataList)for(let t=0;t<favoritList.length;t++)e.id===favoritList[t].id&&(e.favorite=!0)},saveData=e=>{for(const t of e)t.show.image?dataList.push({name:t.show.name,id:t.show.id,image:t.show.image.medium,favorite:!1}):dataList.push({name:t.show.name,id:t.show.id,image:`https://via.placeholder.com/210x295/ffffff/666666/?text=${t.show.name}`,favorite:!1});return dataList},printResultSeries=()=>{if(setSerieAsFavorite(),dataList)for(const e of dataList)createResultElements(e)},resultUL=document.querySelector(".result-list"),createResultElements=e=>{const t=document.createElement("li");t.classList.add("result-list-item"),t.dataset.id=e.id,e.favorite&&t.classList.add("js-favorite"),t.dataset.index=e.id;const i=`<h3 class="result-list-item-title"> ${e.name}</h3>`;let s="";s=`<img class="result-list-item-img" src="${e.image}">`,t.innerHTML=s+i,resultUL.appendChild(t)},deletResultList=()=>{dataList=[],resultUL.innerHTML=""},searchBtn=document.querySelector("#btn-input"),handleBtnClick=()=>{dataList=[],resultUL.innerHTML="",getUserInput(),fetch(`http://api.tvmaze.com/search/shows?q=${searchSerie}`).then(e=>e.json()).then(e=>{saveData(e),printResultSeries()})};searchBtn.addEventListener("click",handleBtnClick);let favoritList=JSON.parse(localStorage.getItem("favorite"))||[],favoritesContainer=[];const printSerieInFavoritesList=()=>{if((favoritesContainer=document.querySelector(".favorites-list")).innerHTML="",JSON.parse(localStorage.getItem("favorite"))){favoritList=JSON.parse(localStorage.getItem("favorite"));for(const e of favoritList){const t=document.createElement("li");t.classList.add("favorites-list-item"),t.dataset.id=e.id,t.innerHTML=e.element+"<img  id='remove-img' src='./assets/images/remove-favorite-img.png' alt=''>",favoritesContainer.appendChild(t)}}};printSerieInFavoritesList();const addSerieOnFavorites=e=>{dataList[e].element=resultListItems[e].innerHTML,dataList[e].favorite=!0,favoritList.push(dataList[e]),localStorage.setItem("favorite",JSON.stringify(favoritList))},removeSerieFromFavories=e=>{for(let t=0;t<favoritList.length;t++)favoritList[t].id===dataList[e].id&&favoritList.splice(favoritList.indexOf(favoritList[t]),1);dataList[e].favorite=!1,localStorage.setItem("favorite",JSON.stringify(favoritList))};let resultListItems=[];const saveSerieInlocal=e=>{for(let t=0;t<resultListItems.length;t++)resultListItems[t]===e.currentTarget&&(dataList[t].favorite?removeSerieFromFavories(t):addSerieOnFavorites(t));return favoritList},changeSerieBG=()=>{for(let e=0;e<dataList.length;e++)dataList[e].favorite?resultListItems[e].classList.add("js-favorite"):resultListItems[e].classList.remove("js-favorite")},handleListClick=e=>{saveSerieInlocal(e),printSerieInFavoritesList(),changeSerieBG()},addEventInResultItems=()=>{resultListItems=document.querySelectorAll(".result-list-item");for(const e of resultListItems)e.addEventListener("click",handleListClick)},main=document.querySelector(".main");main.addEventListener("mouseover",addEventInResultItems);let favoritesItems=document.querySelectorAll(".favorites-list-item");const removeAnImageFromFavoriteList=e=>{for(let t=0;t<favoritList.length;t++)if(favoritList[t].id===parseInt(e.currentTarget.parentElement.dataset.id)){for(let e=0;e<dataList.length;e++)dataList[e].id===favoritList[t].id&&(dataList[e].favorite=!1);favoritList.splice(t,1)}localStorage.setItem("favorite",JSON.stringify(favoritList))},handleRemoveImgClick=e=>{removeAnImageFromFavoriteList(e),printSerieInFavoritesList(),changeSerieBG()},AddEventInRemoveIcons=()=>{const e=document.querySelectorAll("#remove-img");for(const t of e)t.addEventListener("click",handleRemoveImgClick)};favoritesContainer.addEventListener("mouseover",AddEventInRemoveIcons);const removeFavoriteClass=()=>{for(let e=0;e<resultListItems.length;e++)console.log(resultListItems[e]),resultListItems[e].classList.remove("js-favorite")},handleRemoveFavoritesBTNClick=()=>{removeFavoriteClass(),favoritList=[],favoritesContainer.innerHTML="",localStorage.setItem("favorite",JSON.stringify(favoritList))},removeBtn=document.querySelector("#btn-remove-favotites");removeBtn.addEventListener("click",handleRemoveFavoritesBTNClick);